# Istiod - Prod environment
# Production-grade: 3+ replicas, high resources, strict PDB

replicaCount: 3
autoscaleEnabled: true
autoscaleMin: 3
autoscaleMax: 7

resources:
  requests:
    cpu: 1000m
    memory: 4096Mi
  limits:
    cpu: 4000m
    memory: 8192Mi

global:
  istioNamespace: service-mesh
  hub: docker.io/istio
  tag: 1.29.0
  defaultPodDisruptionBudget:
    enabled: true
  proxy:
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 2000m
        memory: 1024Mi
    logLevel: warning
  logging:
    level: "default:warn"
  priorityClassName: system-cluster-critical

meshConfig:
  enablePrometheusMerge: true
  accessLogFile: /dev/stdout
  accessLogEncoding: JSON
  defaultConfig:
    holdApplicationUntilProxyStarts: true
    tracing:
      sampling: 1.0

telemetry:
  enabled: true
  v2:
    enabled: true
    prometheus:
      enabled: true

pilot:
  traceSampling: 1.0

topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: topology.kubernetes.io/zone
    whenUnsatisfiable: DoNotSchedule

pdb:
  minAvailable: 2
